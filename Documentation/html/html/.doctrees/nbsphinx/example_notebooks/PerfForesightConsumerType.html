

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>PerfForesightConsumerType: Perfect foresight consumption-saving &mdash; HARK latest documentation</title>
  

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/theme_overrides.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> HARK
          

          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../quick-start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributing/CONTRIBUTING.html">Contributing to Econ-ARK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../reference/index.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../CHANGELOG.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../license.html">License</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Notebooks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../example_notebooks/Gentle-Intro-To-HARK.html">A Gentle Introduction to HARK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../example_notebooks/PerfForesightConsumerType.html">PerfForesightConsumerType: Perfect foresight consumption-saving</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../example_notebooks/IndShockConsumerType.html">IndShockConsumerType Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../example_notebooks/KinkedRconsumerType.html">KinkedRconsumerType: Consumption-saving model with idiosyncratic income shocks and different interest rates on borrowing and saving</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../example_notebooks/GenIncProcessModel.html">Permanent versus Persistent Income Shocks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../example_notebooks/LifecycleModel.html">The Distribution of Assets By Age</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../example_notebooks/HowWeSolveIndShockConsumerType.html">How we solve a model defined by the <code class="docutils literal notranslate"><span class="pre">IndShockConsumerType</span></code> class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../example_notebooks/Journey_1_PhD.html">Journey 1: 1st year PhD student</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">HARK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>PerfForesightConsumerType: Perfect foresight consumption-saving</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../../_sources/html/.doctrees/nbsphinx/example_notebooks/PerfForesightConsumerType.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="PerfForesightConsumerType:-Perfect-foresight-consumption-saving">
<h1>PerfForesightConsumerType: Perfect foresight consumption-saving<a class="headerlink" href="#PerfForesightConsumerType:-Perfect-foresight-consumption-saving" title="Permalink to this headline">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Initial imports and notebook setup, click arrow to show</span>

<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">HARK.ConsumptionSaving.ConsIndShockModel</span> <span class="kn">import</span> <span class="n">PerfForesightConsumerType</span>
<span class="kn">from</span> <span class="nn">HARK.utilities</span> <span class="kn">import</span> <span class="n">plot_funcs</span>

<span class="n">mystr</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">number</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The module <code class="docutils literal notranslate"><span class="pre">HARK.ConsumptionSaving.ConsIndShockModel</span></code> concerns consumption-saving models with idiosyncratic shocks to (non-capital) income. All of the models assume CRRA utility with geometric discounting, no bequest motive, and income shocks are fully transitory or fully permanent.</p>
<p><code class="docutils literal notranslate"><span class="pre">ConsIndShockModel</span></code> currently includes three models: 1. A very basic “perfect foresight” model with no uncertainty. 2. A model with risk over transitory and permanent income shocks. 3. The model described in (2), with an interest rate for debt that differs from the interest rate for savings.</p>
<p>This notebook provides documentation for the first of these three models. <span class="math notranslate nohighlight">\(\newcommand{\CRRA}{\rho}\)</span> <span class="math notranslate nohighlight">\(\newcommand{\DiePrb}{\mathsf{D}}\)</span> <span class="math notranslate nohighlight">\(\newcommand{\PermGroFac}{\Gamma}\)</span> <span class="math notranslate nohighlight">\(\newcommand{\Rfree}{\mathsf{R}}\)</span> <span class="math notranslate nohighlight">\(\newcommand{\DiscFac}{\beta}\)</span></p>
<div class="section" id="Statement-of-perfect-foresight-consumption-saving-model">
<h2>Statement of perfect foresight consumption-saving model<a class="headerlink" href="#Statement-of-perfect-foresight-consumption-saving-model" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">PerfForesightConsumerType</span></code> class the problem of a consumer with Constant Relative Risk Aversion utility <span class="math notranslate nohighlight">\({\CRRA}\)</span> <span class="math">\begin{equation}
U(C) = \frac{C^{1-\CRRA}}{1-\rho},
\end{equation}</span> has perfect foresight about everything except whether he will die between the end of period <span class="math notranslate nohighlight">\(t\)</span> and the beginning of period <span class="math notranslate nohighlight">\(t+1\)</span>, which occurs with probability <span class="math notranslate nohighlight">\(\DiePrb_{t+1}\)</span>. Permanent labor income <span class="math notranslate nohighlight">\(P_t\)</span> grows from period <span class="math notranslate nohighlight">\(t\)</span> to period <span class="math notranslate nohighlight">\(t+1\)</span> by factor <span class="math notranslate nohighlight">\(\PermGroFac_{t+1}\)</span>.</p>
<p>At the beginning of period <span class="math notranslate nohighlight">\(t\)</span>, the consumer has an amount of market resources <span class="math notranslate nohighlight">\(M_t\)</span> (which includes both market wealth and currrent income) and must choose how much of those resources to consume <span class="math notranslate nohighlight">\(C_t\)</span> and how much to retain in a riskless asset <span class="math notranslate nohighlight">\(A_t\)</span>, which will earn return factor <span class="math notranslate nohighlight">\(\Rfree\)</span>. The consumer cannot necessarily borrow arbitarily; instead, he might be constrained to have a wealth-to-income ratio at least as great as some “artificial borrowing constraint”
<span class="math notranslate nohighlight">\(\underline{a} \leq 0\)</span>.</p>
<p>The agent’s flow of future utility <span class="math notranslate nohighlight">\(U(C_{t+n})\)</span> from consumption is geometrically discounted by factor <span class="math notranslate nohighlight">\(\DiscFac\)</span> per period. If the consumer dies, he receives zero utility flow for the rest of time.</p>
<p>The agent’s problem can be written in Bellman form as:</p>
<p><span class="math">\begin{eqnarray*}
V_t(M_t,P_t) &=& \max_{C_t}~U(C_t) ~+ \DiscFac (1 - \DiePrb_{t+1}) V_{t+1}(M_{t+1},P_{t+1}), \\
& s.t. & \\
A_t &=& M_t - C_t, \\
A_t/P_t &\geq& \underline{a}, \\
M_{t+1} &=& \Rfree A_t + Y_{t+1}, \\
Y_{t+1} &=& P_{t+1}, \\
P_{t+1} &=& \PermGroFac_{t+1} P_t.
\end{eqnarray*}</span></p>
<p>The consumer’s problem is characterized by a coefficient of relative risk aversion <span class="math notranslate nohighlight">\(\CRRA\)</span>, an intertemporal discount factor <span class="math notranslate nohighlight">\(\DiscFac\)</span>, an interest factor <span class="math notranslate nohighlight">\(\Rfree\)</span>, and age-varying sequences of the permanent income growth factor <span class="math notranslate nohighlight">\(\PermGroFac_t\)</span> and survival probability <span class="math notranslate nohighlight">\((1 - \DiePrb_t)\)</span>.</p>
<p>While it does not reduce the computational complexity of the problem (as permanent income is deterministic, given its initial condition <span class="math notranslate nohighlight">\(P_0\)</span>), HARK represents this problem with <em>normalized</em> variables (represented in lower case), dividing all real variables by permanent income <span class="math notranslate nohighlight">\(P_t\)</span> and utility levels by <span class="math notranslate nohighlight">\(P_t^{1-\CRRA}\)</span>. The Bellman form of the model thus reduces to:</p>
<p><span class="math">\begin{eqnarray*}
v_t(m_t) &=& \max_{c_t}~U(c_t) ~+ \DiscFac (1 - \DiePrb_{t+1}) \PermGroFac_{t+1}^{1-\CRRA} v_{t+1}(m_{t+1}), \\
& s.t. & \\
a_t &=& m_t - c_t, \\
a_t &\geq& \underline{a}, \\
m_{t+1} &=& \Rfree/\PermGroFac_{t+1} a_t + 1.
\end{eqnarray*}</span></p>
</div>
<div class="section" id="Solution-method-for-PerfForesightConsumerType">
<h2>Solution method for PerfForesightConsumerType<a class="headerlink" href="#Solution-method-for-PerfForesightConsumerType" title="Permalink to this headline">¶</a></h2>
<p>Because of the assumptions of CRRA utility, no risk other than mortality, and no artificial borrowing constraint, the problem has a closed form solution. In fact, the consumption function is perfectly linear, and the value function composed with the inverse utility function is also linear. The mathematical solution of this model is described in detail in the lecture notes <a class="reference external" href="https://www.econ2.jhu.edu/people/ccarroll/public/lecturenotes/consumption/PerfForesightCRRA">PerfForesightCRRA</a>.</p>
<p>The one period problem for this model is solved by the function <code class="docutils literal notranslate"><span class="pre">solveConsPerfForesight</span></code>, which creates an instance of the class <code class="docutils literal notranslate"><span class="pre">ConsPerfForesightSolver</span></code>. To construct an instance of the class <code class="docutils literal notranslate"><span class="pre">PerfForesightConsumerType</span></code>, several parameters must be passed to its constructor as shown in the table below.</p>
</div>
<div class="section" id="Example-parameter-values-to-construct-an-instance-of-PerfForesightConsumerType">
<h2>Example parameter values to construct an instance of PerfForesightConsumerType<a class="headerlink" href="#Example-parameter-values-to-construct-an-instance-of-PerfForesightConsumerType" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 30%" />
<col style="width: 18%" />
<col style="width: 18%" />
<col style="width: 18%" />
<col style="width: 18%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Code</p></th>
<th class="head"><p>Example value</p></th>
<th class="head"><p>Time-varying?</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\DiscFac\)</span></p></td>
<td><p>Intertemporal discount factor</p></td>
<td><p><span class="math notranslate nohighlight">\(\texttt{DiscFac}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0.96\)</span></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>$:nbsphinx-math:<a href="#id1"><span class="problematic" id="id2">`</span></a>CRRA <a href="#id3"><span class="problematic" id="id4">`</span></a>$</p></td>
<td><p>Coefficient of relative risk aversion</p></td>
<td><p><span class="math notranslate nohighlight">\(\texttt{CRRA}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2.0\)</span></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\Rfree\)</span></p></td>
<td><p>Risk free interest factor</p></td>
<td><p><span class="math notranslate nohighlight">\(\texttt{Rfree}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1.03\)</span></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(1 - \DiePrb_{t+1}\)</span></p></td>
<td><p>Survival probability</p></td>
<td><p><span class="math notranslate nohighlight">\(\texttt{LivPrb}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\([0.98]\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\surd\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\PermGroFac_{t+1}\)</span></p></td>
<td><p>Permanent income growth factor</p></td>
<td><p><span class="math notranslate nohighlight">\(\texttt{PermGroFac}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\([1.01]\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\surd\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\underline{a}\)</span></p></td>
<td><p>Artificial borrowing constraint</p></td>
<td><p><span class="math notranslate nohighlight">\(\texttt{BoroCnstArt}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(None\)</span></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\((none)\)</span></p></td>
<td><p>Maximum number of gridpoints in consumption function</p></td>
<td><p><span class="math notranslate nohighlight">\(\texttt{aXtraCount}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(200\)</span></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(T\)</span></p></td>
<td><p>Number of periods in this type’s “cycle”</p></td>
<td><p><span class="math notranslate nohighlight">\(\texttt{T_cycle}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>(none)</p></td>
<td><p>Number of times the “cycle” occurs</p></td>
<td><p><span class="math notranslate nohighlight">\(\texttt{cycles}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td></td>
</tr>
</tbody>
</table>
<p>Note that the survival probability and income growth factor have time subscripts; likewise, the example values for these parameters are <em>lists</em> rather than simply single floats. This is because those parameters are <em>time-varying</em>: their values can depend on which period of the problem the agent is in. All time-varying parameters <em>must</em> be specified as lists, even if the same value occurs in each period for this type.</p>
<p>The artificial borrowing constraint can be any non-positive <code class="docutils literal notranslate"><span class="pre">float</span></code>, or it can be <code class="docutils literal notranslate"><span class="pre">None</span></code> to indicate no artificial borrowing constraint. The maximum number of gridpoints in the consumption function is only relevant if the borrowing constraint is not <code class="docutils literal notranslate"><span class="pre">None</span></code>; without an upper bound on the number of gridpoints, kinks in the consumption function will propagate indefinitely in an infinite horizon model if there is a borrowing constraint, eventually resulting in an overflow error. If there is no
artificial borrowing constraint, then the number of gridpoints used to represent the consumption function is always exactly two.</p>
<p>The last two parameters in the table specify the “nature of time” for this type: the number of (non-terminal) periods in this type’s “cycle”, and the number of times that the “cycle” occurs. <em>Every</em> subclass of <code class="docutils literal notranslate"><span class="pre">AgentType</span></code> uses these two code parameters to define the nature of time. Here, <code class="docutils literal notranslate"><span class="pre">T_cycle</span></code> has the value <span class="math notranslate nohighlight">\(1\)</span>, indicating that there is exactly one period in the cycle, while <code class="docutils literal notranslate"><span class="pre">cycles</span></code> is <span class="math notranslate nohighlight">\(0\)</span>, indicating that the cycle is repeated in <em>infinite</em> number of times– it is an
infinite horizon model, with the same “kind” of period repeated over and over.</p>
<p>In contrast, we could instead specify a life-cycle model by setting <code class="docutils literal notranslate"><span class="pre">T_cycle</span></code> to <span class="math notranslate nohighlight">\(1\)</span>, and specifying age-varying sequences of income growth and survival probability. In all cases, the number of elements in each time-varying parameter should exactly equal <span class="math notranslate nohighlight">\(\texttt{T_cycle}\)</span>.</p>
<p>The parameter <span class="math notranslate nohighlight">\(\texttt{AgentCount}\)</span> specifies how many consumers there are of this <em>type</em>– how many individuals have these exact parameter values and are <em>ex ante</em> homogeneous. This information is not relevant for solving the model, but is needed in order to simulate a population of agents, introducing <em>ex post</em> heterogeneity through idiosyncratic shocks. Of course, simulating a perfect foresight model is quite boring, as there are <em>no</em> idiosyncratic shocks other than death!</p>
<p>The cell below defines a dictionary that can be passed to the constructor method for <code class="docutils literal notranslate"><span class="pre">PerfForesightConsumerType</span></code>, with the values from the table here.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">PerfForesightDict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># Parameters actually used in the solution method</span>
    <span class="s2">&quot;CRRA&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>  <span class="c1"># Coefficient of relative risk aversion</span>
    <span class="s2">&quot;Rfree&quot;</span><span class="p">:</span> <span class="mf">1.03</span><span class="p">,</span>  <span class="c1"># Interest factor on assets</span>
    <span class="s2">&quot;DiscFac&quot;</span><span class="p">:</span> <span class="mf">0.96</span><span class="p">,</span>  <span class="c1"># Default intertemporal discount factor</span>
    <span class="s2">&quot;LivPrb&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.98</span><span class="p">],</span>  <span class="c1"># Survival probability</span>
    <span class="s2">&quot;PermGroFac&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.01</span><span class="p">],</span>  <span class="c1"># Permanent income growth factor</span>
    <span class="s2">&quot;BoroCnstArt&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># Artificial borrowing constraint</span>
    <span class="s2">&quot;aXtraCount&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>  <span class="c1"># Maximum number of gridpoints in consumption function</span>
    <span class="c1"># Parameters that characterize the nature of time</span>
    <span class="s2">&quot;T_cycle&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1"># Number of periods in the cycle for this agent type</span>
    <span class="s2">&quot;cycles&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1"># Number of times the cycle occurs (0 --&gt; infinitely repeated)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Solving-and-examining-the-solution-of-the-perfect-foresight-model">
<h2>Solving and examining the solution of the perfect foresight model<a class="headerlink" href="#Solving-and-examining-the-solution-of-the-perfect-foresight-model" title="Permalink to this headline">¶</a></h2>
<p>With the dictionary we have just defined, we can create an instance of <code class="docutils literal notranslate"><span class="pre">PerfForesightConsumerType</span></code> by passing the dictionary to the class (as if the class were a function). This instance can then be solved by invoking its <code class="docutils literal notranslate"><span class="pre">solve</span></code> method.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">PFexample</span> <span class="o">=</span> <span class="n">PerfForesightConsumerType</span><span class="p">(</span><span class="o">**</span><span class="n">PerfForesightDict</span><span class="p">)</span>
<span class="n">PFexample</span><span class="o">.</span><span class="n">cycles</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">PFexample</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>The <span class="math notranslate nohighlight">\(\texttt{solve}\)</span> method fills in the instance’s attribute <code class="docutils literal notranslate"><span class="pre">solution</span></code> as a time-varying list of solutions to each period of the consumer’s problem. In this case, <code class="docutils literal notranslate"><span class="pre">solution</span></code> will be a list with exactly one instance of the class <code class="docutils literal notranslate"><span class="pre">ConsumerSolution</span></code>, representing the solution to the infinite horizon model we specified.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">PFexample</span><span class="o">.</span><span class="n">solution</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;HARK.ConsumptionSaving.ConsIndShockModel.ConsumerSolution object at 0x7f7ab2b7e370&gt;]
</pre></div></div>
</div>
<p>Each element of <code class="docutils literal notranslate"><span class="pre">solution</span></code> has a few attributes. To see all of them, we can use the <span class="math">\texttt{vars}</span> built in function:</p>
<p>the consumption functions reside in the attribute <span class="math notranslate nohighlight">\(\texttt{cFunc}\)</span> of each element of <code class="docutils literal notranslate"><span class="pre">ConsumerType.solution</span></code>. This method creates a (time varying) attribute <span class="math notranslate nohighlight">\(\texttt{cFunc}\)</span> that contains a list of consumption functions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">PFexample</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;cFunc&#39;: &lt;HARK.interpolation.LinearInterp object at 0x7f7ab2b7e4f0&gt;, &#39;vFunc&#39;: &lt;HARK.interpolation.ValueFuncCRRA object at 0x7f7ab2b7c7f0&gt;, &#39;vPfunc&#39;: &lt;HARK.interpolation.MargValueFuncCRRA object at 0x7f7ab2b7cb20&gt;, &#39;vPPfunc&#39;: &lt;HARK.utilities.NullFunc object at 0x7f7ab2b7e3a0&gt;, &#39;mNrmMin&#39;: -50.49994992551661, &#39;hNrm&#39;: 50.49994992551661, &#39;MPCmin&#39;: 0.04428139169919579, &#39;MPCmax&#39;: 0.04428139169919579}
</pre></div></div>
</div>
<p>The two most important attributes of a single period solution of this model are the (normalized) consumption function <span class="math notranslate nohighlight">\(\texttt{cFunc}\)</span> and the (normalized) value function <span class="math notranslate nohighlight">\(\texttt{vFunc}\)</span>. Let’s plot those functions near the lower bound of the permissible state space (the attribute <span class="math notranslate nohighlight">\(\texttt{mNrmMin}\)</span> tells us the lower bound of <span class="math notranslate nohighlight">\(m_t\)</span> where the consumption function is defined).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Linear perfect foresight consumption function:&quot;</span><span class="p">)</span>
<span class="n">mMin</span> <span class="o">=</span> <span class="n">PFexample</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">mNrmMin</span>
<span class="n">plot_funcs</span><span class="p">(</span><span class="n">PFexample</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cFunc</span><span class="p">,</span> <span class="n">mMin</span><span class="p">,</span> <span class="n">mMin</span> <span class="o">+</span> <span class="mf">10.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Linear perfect foresight consumption function:
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/html_.doctrees_nbsphinx_example_notebooks_PerfForesightConsumerType_14_1.png" src="../../../../_images/html_.doctrees_nbsphinx_example_notebooks_PerfForesightConsumerType_14_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Perfect foresight value function:&quot;</span><span class="p">)</span>
<span class="n">plot_funcs</span><span class="p">(</span><span class="n">PFexample</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vFunc</span><span class="p">,</span> <span class="n">mMin</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">mMin</span> <span class="o">+</span> <span class="mf">10.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Perfect foresight value function:
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/html_.doctrees_nbsphinx_example_notebooks_PerfForesightConsumerType_15_1.png" src="../../../../_images/html_.doctrees_nbsphinx_example_notebooks_PerfForesightConsumerType_15_1.png" />
</div>
</div>
<p>An element of <code class="docutils literal notranslate"><span class="pre">solution</span></code> also includes the (normalized) marginal value function <span class="math notranslate nohighlight">\(\texttt{vPfunc}\)</span>, and the lower and upper bounds of the marginal propensity to consume (MPC) <span class="math notranslate nohighlight">\(\texttt{MPCmin}\)</span> and <span class="math notranslate nohighlight">\(\texttt{MPCmax}\)</span>. Note that with a linear consumption function, the MPC is constant, so its lower and upper bound are identical.</p>
<div class="section" id="Liquidity-constrained-perfect-foresight-example">
<h3>Liquidity constrained perfect foresight example<a class="headerlink" href="#Liquidity-constrained-perfect-foresight-example" title="Permalink to this headline">¶</a></h3>
<p>Without an artificial borrowing constraint, a perfect foresight consumer is free to borrow against the PDV of his entire future stream of labor income– his “human wealth” <span class="math notranslate nohighlight">\(\texttt{hNrm}\)</span>– and he will consume a constant proportion of his total wealth (market resources plus human wealth). If we introduce an artificial borrowing constraint, both of these features vanish. In the cell below, we define a parameter dictionary that prevents the consumer from borrowing <em>at all</em>, create and solve a
new instance of <code class="docutils literal notranslate"><span class="pre">PerfForesightConsumerType</span></code> with it, and then plot its consumption function.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">LiqConstrDict</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">PerfForesightDict</span><span class="p">)</span>
<span class="n">LiqConstrDict</span><span class="p">[</span><span class="s2">&quot;BoroCnstArt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Set the artificial borrowing constraint to zero</span>

<span class="n">LiqConstrExample</span> <span class="o">=</span> <span class="n">PerfForesightConsumerType</span><span class="p">(</span><span class="o">**</span><span class="n">LiqConstrDict</span><span class="p">)</span>
<span class="n">LiqConstrExample</span><span class="o">.</span><span class="n">cycles</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Make this type be infinite horizon</span>
<span class="n">LiqConstrExample</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Liquidity constrained perfect foresight consumption function:&quot;</span><span class="p">)</span>
<span class="n">plot_funcs</span><span class="p">(</span><span class="n">LiqConstrExample</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cFunc</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Liquidity constrained perfect foresight consumption function:
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/html_.doctrees_nbsphinx_example_notebooks_PerfForesightConsumerType_17_1.png" src="../../../../_images/html_.doctrees_nbsphinx_example_notebooks_PerfForesightConsumerType_17_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># At this time, the value function for a perfect foresight consumer with an artificial borrowing constraint is not computed nor included as part of its $\texttt{solution}$.</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Simulating-the-perfect-foresight-consumer-model">
<h2>Simulating the perfect foresight consumer model<a class="headerlink" href="#Simulating-the-perfect-foresight-consumer-model" title="Permalink to this headline">¶</a></h2>
<p>Suppose we wanted to simulate many consumers who share the parameter values that we passed to <code class="docutils literal notranslate"><span class="pre">PerfForesightConsumerType</span></code>– an <em>ex ante</em> homogeneous <em>type</em> of consumers. To do this, our instance would have to know <em>how many</em> agents there are of this type, as well as their initial levels of assets <span class="math notranslate nohighlight">\(a_t\)</span> and permanent income <span class="math notranslate nohighlight">\(P_t\)</span>.</p>
<div class="section" id="Setting-simulation-parameters">
<h3>Setting simulation parameters<a class="headerlink" href="#Setting-simulation-parameters" title="Permalink to this headline">¶</a></h3>
<p>Let’s fill in this information by passing another dictionary to <code class="docutils literal notranslate"><span class="pre">PFexample</span></code> with simulation parameters. The table below lists the parameters that an instance of <code class="docutils literal notranslate"><span class="pre">PerfForesightConsumerType</span></code> needs in order to successfully simulate its model using the <code class="docutils literal notranslate"><span class="pre">simulate</span></code> method.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 54%" />
<col style="width: 32%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Description</p></th>
<th class="head"><p>Code</p></th>
<th class="head"><p>Example value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Number of consumers of this type</p></td>
<td><p><span class="math notranslate nohighlight">\(\texttt{AgentCount}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(10000\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Number of periods to simulate</p></td>
<td><p><span class="math notranslate nohighlight">\(\texttt{T_sim}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(120\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Mean of initial log (normalized) assets</p></td>
<td><p><span class="math notranslate nohighlight">\(\texttt{aNrmInitMean}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(-6.0\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Stdev of initial log (normalized) assets</p></td>
<td><p><span class="math notranslate nohighlight">\(\texttt{aNrmInitStd}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1.0\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Mean of initial log permanent income</p></td>
<td><p><span class="math notranslate nohighlight">\(\texttt{pLvlInitMean}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0.0\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Stdev of initial log permanent income</p></td>
<td><p><span class="math notranslate nohighlight">\(\texttt{pLvlInitStd}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0.0\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Aggregrate productivity growth factor</p></td>
<td><p><span class="math notranslate nohighlight">\(\texttt{PermGroFacAgg}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1.0\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Age after which consumers are automatically killed</p></td>
<td><p><span class="math notranslate nohighlight">\(\texttt{T_age}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(None\)</span></p></td>
</tr>
</tbody>
</table>
<p>We have specified the model so that initial assets and permanent income are both distributed lognormally, with mean and standard deviation of the underlying normal distributions provided by the user.</p>
<p>The parameter <span class="math notranslate nohighlight">\(\texttt{PermGroFacAgg}\)</span> exists for compatibility with more advanced models that employ aggregate productivity shocks; it can simply be set to 1.</p>
<p>In infinite horizon models, it might be useful to prevent agents from living extraordinarily long lives through a fortuitous sequence of mortality shocks. We have thus provided the option of setting <span class="math notranslate nohighlight">\(\texttt{T_age}\)</span> to specify the maximum number of periods that a consumer can live before they are automatically killed (and replaced with a new consumer with initial state drawn from the specified distributions). This can be turned off by setting it to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>The cell below puts these parameters into a dictionary, then gives them to <code class="docutils literal notranslate"><span class="pre">PFexample</span></code>. Note that all of these parameters <em>could</em> have been passed as part of the original dictionary; we omitted them above for simplicity.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">SimulationParams</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;AgentCount&quot;</span><span class="p">:</span> <span class="mi">10000</span><span class="p">,</span>  <span class="c1"># Number of agents of this type</span>
    <span class="s2">&quot;T_sim&quot;</span><span class="p">:</span> <span class="mi">120</span><span class="p">,</span>  <span class="c1"># Number of periods to simulate</span>
    <span class="s2">&quot;aNrmInitMean&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">6.0</span><span class="p">,</span>  <span class="c1"># Mean of log initial assets</span>
    <span class="s2">&quot;aNrmInitStd&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>  <span class="c1"># Standard deviation of log initial assets</span>
    <span class="s2">&quot;pLvlInitMean&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># Mean of log initial permanent income</span>
    <span class="s2">&quot;pLvlInitStd&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># Standard deviation of log initial permanent income</span>
    <span class="s2">&quot;PermGroFacAgg&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>  <span class="c1"># Aggregate permanent income growth factor</span>
    <span class="s2">&quot;T_age&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># Age after which simulated agents are automatically killed</span>
<span class="p">}</span>

<span class="n">PFexample</span><span class="o">.</span><span class="n">assign_parameters</span><span class="p">(</span><span class="o">**</span><span class="n">SimulationParams</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>To generate simulated data, we need to specify which variables we want to track the “history” of for this instance. To do so, we set the <code class="docutils literal notranslate"><span class="pre">track_vars</span></code> attribute of our <code class="docutils literal notranslate"><span class="pre">PerfForesightConsumerType</span></code> instance to be a list of strings with the simulation variables we want to track.</p>
<p>In this model, valid arguments to <code class="docutils literal notranslate"><span class="pre">track_vars</span></code> include <span class="math notranslate nohighlight">\(\texttt{mNrm}\)</span>, <span class="math notranslate nohighlight">\(\texttt{cNrm}\)</span>, <span class="math notranslate nohighlight">\(\texttt{aNrm}\)</span>, and <span class="math notranslate nohighlight">\(\texttt{pLvl}\)</span>. Because this model has no idiosyncratic shocks, our simulated data will be quite boring.</p>
</div>
<div class="section" id="Generating-simulated-data">
<h3>Generating simulated data<a class="headerlink" href="#Generating-simulated-data" title="Permalink to this headline">¶</a></h3>
<p>Before simulating, the <code class="docutils literal notranslate"><span class="pre">initialize_sim</span></code> method must be invoked. This resets our instance back to its initial state, drawing a set of initial <span class="math notranslate nohighlight">\(\texttt{aNrm}\)</span> and <span class="math notranslate nohighlight">\(\texttt{pLvl}\)</span> values from the specified distributions and storing them in the attributes <span class="math notranslate nohighlight">\(\texttt{aNrmNow_init}\)</span> and <span class="math notranslate nohighlight">\(\texttt{pLvlNow_init}\)</span>. It also resets this instance’s internal random number generator, so that the same initial states will be set every time <code class="docutils literal notranslate"><span class="pre">initialize_sim</span></code> is called. In models with
non-trivial shocks, this also ensures that the same sequence of shocks will be generated on every simulation run.</p>
<p>Finally, the <code class="docutils literal notranslate"><span class="pre">simulate</span></code> method can be called.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">PFexample</span><span class="o">.</span><span class="n">track_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mNrm&#39;</span><span class="p">]</span>
<span class="n">PFexample</span><span class="o">.</span><span class="n">initialize_sim</span><span class="p">()</span>
<span class="n">PFexample</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;mNrm&#39;: array([[  1.01834458,   1.00217811,   1.00344698, ...,   1.00498677,
           1.00181962,   1.00082289],
        [ -0.28796625,  -0.3037228 ,  -0.30248611, ...,  -0.30098536,
           1.00624616,  -0.30504366],
        [ -1.56115391,  -1.57651094,  -1.5753056 , ...,  -1.57384291,
          -0.2997579 ,  -1.5777983 ],
        ...,
        [-38.27661177, -47.94841819, -47.94835533, ..., -44.8431327 ,
         -14.5538836 , -18.88031749],
        [-38.58654905, -48.01311453, -48.01305326, ..., -44.9865675 ,
         -15.4653408 , -19.68207246],
        [-38.88862747, -48.07617041, -48.0761107 , ..., -45.12636532,
         -16.35368684,   1.00096976]])}
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Each simulation variable $\texttt{X}$ named in $\texttt{track_vars}$ will have the *history* of that variable for each agent stored in the attribute $\texttt{X_hist}$ as an array of shape $(\texttt{T_sim},\texttt{AgentCount})$.  To see that the simulation worked as intended, we can plot the mean of $m_t$ in each simulated period:</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">PFexample</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;mNrm&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Mean normalized market resources&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/html_.doctrees_nbsphinx_example_notebooks_PerfForesightConsumerType_24_0.png" src="../../../../_images/html_.doctrees_nbsphinx_example_notebooks_PerfForesightConsumerType_24_0.png" />
</div>
</div>
<p>A perfect foresight consumer can borrow against the PDV of his future income– his human wealth– and thus as time goes on, our simulated agents approach the (very negative) steady state level of <span class="math notranslate nohighlight">\(m_t\)</span> while being steadily replaced with consumers with roughly <span class="math notranslate nohighlight">\(m_t=1\)</span>.</p>
<p>The slight wiggles in the plotted curve are due to consumers randomly dying and being replaced; their replacement will have an initial state drawn from the distributions specified by the user. To see the current distribution of ages, we can look at the attribute <span class="math notranslate nohighlight">\(\texttt{t_age}\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">N</span> <span class="o">=</span> <span class="n">PFexample</span><span class="o">.</span><span class="n">AgentCount</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">PFexample</span><span class="o">.</span><span class="n">t_age</span><span class="p">),</span> <span class="n">F</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Current age of consumers&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Cumulative distribution&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/html_.doctrees_nbsphinx_example_notebooks_PerfForesightConsumerType_26_0.png" src="../../../../_images/html_.doctrees_nbsphinx_example_notebooks_PerfForesightConsumerType_26_0.png" />
</div>
</div>
<p>The distribution is (discretely) exponential, with a point mass at 120 with consumers who have survived since the beginning of the simulation.</p>
<p>One might wonder why HARK requires users to call <code class="docutils literal notranslate"><span class="pre">initialize_sim</span></code> before calling <code class="docutils literal notranslate"><span class="pre">simulate</span></code>: Why doesn’t <code class="docutils literal notranslate"><span class="pre">simulate</span></code> just call <code class="docutils literal notranslate"><span class="pre">initialize_sim</span></code> as its first step? We have broken up these two steps so that users can simulate some number of periods, change something in the environment, and then resume the simulation.</p>
<p>When called with no argument, <code class="docutils literal notranslate"><span class="pre">simulate</span></code> will simulate the model for <span class="math notranslate nohighlight">\(\texttt{T_sim}\)</span> periods. The user can optionally pass an integer specifying the number of periods to simulate (which should not exceed <span class="math notranslate nohighlight">\(\texttt{T_sim}\)</span>).</p>
<p>In the cell below, we simulate our perfect foresight consumers for 80 periods, then seize a bunch of their assets (dragging their wealth even more negative), then simulate for the remaining 40 periods.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">state_prev</span></code> attribute of an AgenType stores the values of the model’s state variables in the <em>previous</em> period of the simulation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">PFexample</span><span class="o">.</span><span class="n">initialize_sim</span><span class="p">()</span>
<span class="n">PFexample</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
<span class="n">PFexample</span><span class="o">.</span><span class="n">state_prev</span><span class="p">[</span><span class="s1">&#39;aNrm&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="o">-</span><span class="mf">5.0</span>  <span class="c1"># Adjust all simulated consumers&#39; assets downward by 5</span>
<span class="n">PFexample</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">PFexample</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;mNrm&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Mean normalized market resources&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/html_.doctrees_nbsphinx_example_notebooks_PerfForesightConsumerType_28_0.png" src="../../../../_images/html_.doctrees_nbsphinx_example_notebooks_PerfForesightConsumerType_28_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Econ-ARK team.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>